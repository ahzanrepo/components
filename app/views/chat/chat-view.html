<script type="text/ng-template" id="customChatTemplate.html">    <a>        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>    </a></script><div class="row">    <div id="{{chatWindowId}}"         class="chat-wrp animated " ng-style="{'right':chatUser.position}"         data-chat-wid="{{chatUser._id}}">        <!-- chat hedaer -->        <div class="cht-header {{chatUser.status}} {{chatUser.type}}">            <div class="c-opt">                <div class="cht-b-name">                    {{chatUser.firstname}} {{chatUser.lastname}}                </div>                <div class="cht-close" ng-click="closeThisChat(chatUser)">                    <i class="ti-close"></i>                </div>                <div class="cht-close"                     ng-click="minimusChatW(chatUser)" ng-if="chatUser.windowMimOption==true">                    <i class="ti-angle-down"></i>                </div>                <div class="cht-close"                     ng-click="maximusChatW(chatUser)" ng-if="chatUser.windowMimOption==false">                    <i class="ti-angle-up"></i>                </div>            </div>            <div class="c-last-seen">                <small ng-if="chatUser.status=='offline'">                    <time-ago from-time='{{chatUser.lastseen}}'                              format='MM/dd/yyyy'></time-ago>                </small>                <small ng-if="chatUser.status=='online' && !chatUser.channel">                    online                </small>                <small ng-if="chatUser.status=='online' && chatUser.channel ">                    online - {{chatUser.channel}}                </small>            </div>        </div>        <!-- client Request accept -->        <div class="client-acpt" ng-if="chatUser.isNewChat==true">            <div class="cht-img-grp">                <!--<div class="g-rec-img">-->                <!--&lt;!&ndash;ng-src="{{chatUser.avatar}}" &ndash;&gt;-->                <!--<img src="assets/img/avatar/profileAvatar.png"-->                <!--width="40" height="40"/>-->                <!--</div>-->                <div class="g-sed-img">                    <img src="assets/img/avatar/profileAvatar.png" ng-src="{{chatUser.avatar}}"                         width="40" height="40"/>                </div>            </div>            <div class="cht-body">                Request new message                <br/>                {{chatUser.firstname}}            </div>            <div class="client-acpt-txt">                <div class="ignore" ng-click="ignoreChat(chatUser);">                    Ignore                </div>                <div class="accept" ng-click="acceptClient(chatUser)">                    Accept                </div>            </div>        </div>        <!-- chat body -->        <div scroll-glue class="cht-b-w"             exec-on-scroll-to-top="getMoreChats"             ng-if="chatUser.isNewChat==false"             id="{{chatUser._id}}">            <div class="chat-body">                <!-- client  to agent chat id="{{chatUser._id}}" -->                <div class="ch-d-load display-none" ng-if="chatUser.isChatLoding==false">                    <i class="fa fa fa-circle-o-notch fa-spin"></i>                </div>                <div id="chatTempView"                     ng-class="isChatPanel?'temp-p-show':'temp-p-hide'"                     class="ch-temp-list animated slideInUp">                </div>            </div>            <div ng-repeat="msg in chatUser.messageThread">                <!-- start new chat sction -->                <div class="row" ng-if="msg.type=='accept'">                    <div class="chat-type join">                        {{msg.message}} join                    </div>                </div>                <div class="row" ng-if="msg.currentChatDate!=''">                    <div class="chat-start-point text-center">                         {{msg.currentChatDate}}                    </div>                </div>                <div ng-if="msg.type!='accept' && msg.type!='end'">                    <div class="row">                        <div data-sendid="{{msg.id}}" class="snd-msg c-msg"                             ng-if="msg.to == chatUser.username">                            <!--<div class="msg-t" ng-class="msg.status">{{msg.message}}</div>-->                            <div class="msg-t" ng-class="msg.status">                                <ng-embed                                        embed-data="msg.message"                                        embed-options="watchOptions"></ng-embed>                                <div class="msg-send-time">                                    <span ng-if="msg.status=='seen'">                                    </span>                                    {{msg.time}}                                </div>                            </div>                        </div>                    </div>                    <div class="row">                        <div data-resid="{{msg.id}}"                             class="rec-msg c-msg"                             ng-if="msg.from == chatUser.username">                            <div class="rec-img">                                <img src="assets/img/avatar/profileAvatar.png"                                     ng-src="{{chatUser.avatar}}"                                     width="20" height="20"/>                            </div>                            <!--<div class="msg-t">{{msg.message}}</div>-->                            <div class="msg-t">                                <ng-embed embed-data="msg.message" embed-options="watchOptions"></ng-embed>                                <div class="msg-send-time">                                    {{msg.time}}                                </div>                            </div>                        </div>                    </div>                </div>                <div class="row" ng-if="msg.type=='end'">                    <div class="chat-type left">                        {{msg.message}}                    </div>                </div>            </div>            <!-- chat tag details -->            <div class="chat-tag-wrapper"                 ng-if="isOpentagPanel">                <div class="tag-list-wrp animated fadeIn">                    <div slimscroll="{height: '94px',                                    railVisible: true,                                    color: '#CFD0CE',                                    size: '8px',                                    distance: '5px',                                    railColor: '#CFD0CE',                                    railBorderRadius: 10}">                        <ul class="customer-style-ul tag-list">                            <li ng-repeat="tag in tagList.tags track by $index">                                <div class="chat-tag">                                    {{tag.data}}                                </div>                            </li>                        </ul>                    </div>                </div>                <div class="tag-add-wrapper">                    <div class="form-group">                        <input class="form-control txt-tag-input"                               placeholder="add tag here.."                               ng-keypress="onKerPressAddTag($event,chatUser)"                               ng-model="msgObj.tabTxt"/>                    </div>                </div>            </div>            <!--end -->        </div>        <!-- chat footer &&on type layout  -->        <div ng-if="chatUser.isNewChat==false" class="chat-op">            <div class="row">                <div class="type-wrp animated"                     ng-if="chatUser.typing==true"                     ng-class="chatUser.typing ? 'fadeInUp' :'fadeInDown'">                    <div class="rec-img">                        <img ng-src="{{chatUser.avatar}}"                             src="assets/img/avatar/profileAvatar.png"                             width="20" height="20"/>                    </div>                    <!--<pb-circle-->                    <!--progress-key="myCircle"-->                    <!--options="circleOptions">-->                    <div class="ty-ani-body">                        <span class="typing"></span>                        <span class="typing"></span>                        <span class="typing"></span>                    </div>                </div>                <div class="option-c-wrp animated slideInUp">                    <ul>                        <!-- chat template  -->                        <li class="opt-c-row-wp"                            ng-click="showTemplatePanel()"                            ng-if="!progressVisible">                            <i title="Chat Template"                               class="ti-layout-cta-right cht-op-2"></i>                        </li>                        <li class="opt-c-row-wp" ng-if="!progressVisible">                            <i title="Attachment"                               class="ti-clip opt-c-row-w"                               ng-click="selectFile()"></i>                            <input type="file" style="display:none" id="file" name='file'                                   onchange="angular.element(this).scope().fileNameChanged(this)">                        </li>                        <li class="opt-c-row-wp"                            ng-if="progressVisible">                            <i class="fa fa-circle-o-notch fa-spin" style="color: #36ba45"></i>                        </li>                        <!-- open profile  -->                        <li ng-if="chatUser.type=='client'"                            class="opt-c-row-wp {{chatUser.type}}"                            ng-click="createNewProfile(chatUser)">                            <i title="Open Profile"                               class="ti-user  cht-op-2"></i>                        </li>                        <li ng-if="chatUser.type!='client'"                            class="opt-c-row-wp">                            <i title="Open Profile"                               class="ti-user cht-op-2 deactivate"></i>                        </li>                        <!-- end conversation -->                        <li ng-if="chatUser.type=='client' && msgObj.chatText"                            class="opt-c-row-wp {{chatUser.type}}"                            ng-click="clientChatEndSession(chatUser)">                            <i title="End Conversation"                               class="ti-unlink cht-op-2"></i>                        </li>                        <li ng-if="chatUser.type=='client' && !msgObj.chatText"                            class="opt-c-row-wp">                            <i title="End Conversation"                               class="ti-unlink cht-op-2 deactivate"></i>                        </li>                        <li ng-if="chatUser.type!='client'"                            class="opt-c-row-wp">                            <i title="End Conversation"                               class="ti-unlink cht-op-2 deactivate"></i>                        </li>                        <!-- add tag -->                        <li class="opt-c-row-wp"                            ng-if="chatUser.type=='client'"                            ng-click="openChatTagView()">                            <i ng-if="!isOpentagPanel"                               title="Tag"                               class="ti-tag cht-op-2"></i>                            <i ng-if="isOpentagPanel"                               title="Close Tag"                               class="ti-close cht-op-2"></i>                        </li>                        <!-- disable icon -->                        <li class="opt-c-row-wp"                            ng-if="chatUser.type!='client'">                            <i title="Tag"                               class="ti-tag cht-op-2 deactivate "></i>                        </li>                        <!-- end -->                    </ul>                </div>            </div>        </div>        <!-- chat footer layout --->        <div ng-if="chatUser.isNewChat==false" class="ch-footer">            <div class="col-lg-12" style="padding: 0px">                <!---->                <input class="form-control chat-txt " type="text" id="chatInput" name="chatInput"                       placeholder="Type message here..."                       ng-model="msgObj.chatText"                       ng-focus="onFocusChat()"                       ng-blur="onFocusOutChat()"                       ng-keypress="onKeyPressed($event,chatUser,chatText)">                <!--emoji-picker="emoji-picker"-->                <!--emoji-attachment-location="bottom left"-->                <!--emoji-menu-location="top left"-->                <!--<input emoji-picker type="text" class="form-control chat-txt "-->                <!--class="form-control chat-txt "-->                <!--emoji-picker-->                <!--placeholder="Type a message..."-->                <!--ng-model="chatText"-->                <!--ng-focus="onFocusChat()"-->                <!--ng-blur="onFocusOutChat()"-->                <!--ng-keypress="onKeyPressed($event,chatUser,chatText)">-->            </div>        </div>    </div>    <!--Chat templates -->    <div ng-include="'app/views/chat/partials/chat-template-view.html'"></div></div>